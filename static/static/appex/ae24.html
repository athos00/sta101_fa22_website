<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Forensic genetic analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ae24_files/libs/clipboard/clipboard.min.js"></script>
<script src="ae24_files/libs/quarto-html/quarto.js"></script>
<script src="ae24_files/libs/quarto-html/popper.min.js"></script>
<script src="ae24_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ae24_files/libs/quarto-html/anchor.min.js"></script>
<link href="ae24_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ae24_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ae24_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ae24_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ae24_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Forensic genetic analysis</h1>
<p class="subtitle lead">STA 101</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="bulletin" class="level2">
<h2 class="anchored" data-anchor-id="bulletin">Bulletin</h2>
<ul>
<li>Wednesday office hours moved to Thursday after class</li>
<li>Lab 09 due Thursday. Draft peer-report due Friday (in lab review)</li>
<li>course evaluations open. <span class="math inline">\(&gt;80\%\)</span> response <span class="math inline">\(\rightarrow\)</span> +1pt final project</li>
</ul>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting started</h2>
<p>Download this application exercise by pasting the code below into your <strong>console</strong></p>
<pre><code>download.file("https://sta101-fa22.netlify.app/static/appex/ae24.qmd",
destfile = "ae24.qmd")</code></pre>
</section>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>DNA evidence is sometimes used in court. In this AE, you will learn about the case of Dr.&nbsp;Schmidt from Lafayette, Louisiana, who was accused of infecting his former lover with HIV through a contaminated blood sample of one of his patients. Read more about this court case <a href="https://www.wired.com/story/strands-of-evidence-genetic-testing-trial/">here</a> and <a href="https://www.science.org/content/article/novel-dna-evidence-may-get-its-day-court">here</a>.</p>
</section>
<section id="today" class="level2">
<h2 class="anchored" data-anchor-id="today">Today</h2>
<p>By the end of today you will</p>
<ul>
<li><p>be able to critical think about the use of DNA evidence and statistics in court</p></li>
<li><p>analyze non-numerical data rigorously</p></li>
</ul>
</section>
<section id="explore-the-data" class="level2">
<h2 class="anchored" data-anchor-id="explore-the-data">Explore the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_HIV <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"https://sta101-fa22.netlify.app/static/appex/data/HIV.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>df_HIV</code> contains several observations of HIV genomes. Within this data set are two samples with special ids: <code>sample1</code> and <code>sample2</code>.</p>
<p>For the purpose of this exercise, you might imagine <code>sample1</code> is associated with the HIV sampled from the plaintiff while <code>sample2</code> belongs to that of the defendant’s patient.</p>
<p>Fundamentally, we are interested in whether or not <code>sample1</code> and <code>sample2</code> are closely related.</p>
<section id="exercise-1" class="level4">
<h4 class="anchored" data-anchor-id="exercise-1">Exercise 1</h4>
<ul>
<li><p>how many observations are present in the data set?</p></li>
<li><p>what are the observational units?</p></li>
<li><p>how many bases does the first DNA sequence contain? Hint: use the <code>R</code> function <code>nchar</code>.</p></li>
</ul>
</section>
</section>
<section id="extracting-a-sub-sequence-of-dna" class="level2">
<h2 class="anchored" data-anchor-id="extracting-a-sub-sequence-of-dna">Extracting a sub-sequence of DNA</h2>
<p>For computational speed, we will have to work with shorter sub-sequences of DNA.</p>
<p>The function <code>str_sub</code> from the package <code>stringr</code> in the <code>Tidyverse</code> can be used to extract a sub-string from a character vector.</p>
<section id="exercise-2" class="level4">
<h4 class="anchored" data-anchor-id="exercise-2">Exercise 2</h4>
<ul>
<li><p>how many arguments does the function <code>str_sub</code> take? What does each argument do?</p></li>
<li><p>use <code>str_sub</code> to extract (i) the first four letters of the words <em>statistics</em>, (ii) the sub-string between the third and the seventh letters, and (iii) the last four letters</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>term <span class="ot">=</span> <span class="st">"statistics"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s use <code>str_sub</code> to extract the first 500 bases from the DNA sequences using the template below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>HIV <span class="ot">=</span> df_HIV <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dna_short =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>dna)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>use <code>nchar</code> to verify that each sub-sequence <code>dna_short</code> contains 500 bases. Hint: <code>nchar</code> is vectorized, meaning if given a vector input, it will return a vector output.</li>
</ul>
</section>
</section>
<section id="computing-the-pairwise-distances-between-the-dna-sequence" class="level2">
<h2 class="anchored" data-anchor-id="computing-the-pairwise-distances-between-the-dna-sequence">Computing the pairwise distances between the DNA sequence</h2>
<p>Now that the data have been prepared, we will establish how similar/different each DNA sequence is to the others. To accomplish this, given two DNA sequences we will count the number of bases for which they differ. The rationale for this step is the following. If two DNA differ on many bases, it means that they have evolved separately for a while and had the time to undergo numerous mutations. On the other hand, if they only differ on a few bases, it means that the two sequences have only recently began to evolve separately.</p>
<p>The following code creates a data frame where each row corresponds to a pair of DNA sequences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>d_pairs <span class="ot">&lt;-</span> <span class="fu">combn</span>(HIV<span class="sc">$</span>person_id, <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="co"># go from wide matrix (2 rows) to long matrix (2 columns)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id1 =</span> V1, <span class="at">id2 =</span> V2) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(HIV, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id1"</span> <span class="ot">=</span> <span class="st">"person_id"</span>)) <span class="sc">%&gt;%</span> <span class="co"># add dna for person 1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dna1 =</span> dna_short) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(HIV, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id2"</span> <span class="ot">=</span> <span class="st">"person_id"</span>)) <span class="sc">%&gt;%</span> <span class="co"># add dna for person 1</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dna2 =</span> dna_short)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Question</strong>: What are the dimensions of <code>d_pairs</code>?</p>
<section id="hamming-distance" class="level3">
<h3 class="anchored" data-anchor-id="hamming-distance">Hamming distance</h3>
<p>To measure the distance between two sequences, we first consider the Hamming distance</p>
<p><span class="math display">\[
d(i,j) = \sum_{k=1}^n 1\{\text{dna}_{ik} \neq \text{dna}_{jk}\}
\]</span></p>
<p>which counts the number of elements that are different between two sequences. Here <span class="math inline">\(d(i,j)\)</span> denotes the Hamming distance between sequences <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, and <span class="math inline">\(1\{\text{dna}_{ik} \neq \text{dna}_{jk}\}\)</span> is equal to <span class="math inline">\(1\)</span> is the <span class="math inline">\(k\)</span>-th element of sequence <span class="math inline">\(i\)</span> is different from that of sequence <span class="math inline">\(j\)</span>.</p>
<p>The following code computes the Hamming distance between each pair of sequences. We first construct function <code>compute_hamming</code> which computes the Hamming distance between two DNA sequences. We then apply this function to each row of the <code>d_pairs</code> data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>compute_hamming <span class="ot">&lt;-</span> <span class="cf">function</span>(dna1, dna2) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dna1_split <span class="ot">&lt;-</span> <span class="fu">str_split</span>(dna1, <span class="at">pattern =</span> <span class="st">""</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dna2_split <span class="ot">&lt;-</span> <span class="fu">str_split</span>(dna2, <span class="at">pattern =</span> <span class="st">""</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  hamming_distance <span class="ot">&lt;-</span> <span class="fu">sum</span>(dna1_split <span class="sc">!=</span> dna2_split)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(hamming_distance)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>d_hamming <span class="ot">&lt;-</span> d_pairs <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance_ham =</span> <span class="fu">list</span>(dna1, dna2) <span class="sc">%&gt;%</span> <span class="fu">pmap_dbl</span>(compute_hamming)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercise-3" class="level4">
<h4 class="anchored" data-anchor-id="exercise-3">Exercise 3</h4>
<ul>
<li>Make a histogram of the Hamming distances and describe the distribution.</li>
</ul>
<div class="cell">

</div>
<ul>
<li>Find the 10 pairs of DNA sequences that are the closest to the plaintiff’s sequence in terms of Hamming distance.</li>
</ul>
<div class="cell">

</div>
<ul>
<li><p>Which sequence is most closely related to the plaintiff’s sequence?</p></li>
<li><p>How many differences are there between the DNA sequence of the plaintiff and that of the defendant’s patient?</p></li>
<li><p>Can you identify a shortcoming of the Hamming distance? Does a large Hamming distance necessarily imply that the two DNA sequences are very different?</p></li>
</ul>
</section>
</section>
<section id="an-alternative-measure-of-distance-for-dna-sequences" class="level3">
<h3 class="anchored" data-anchor-id="an-alternative-measure-of-distance-for-dna-sequences">An alternative measure of distance for DNA sequences</h3>
<p>Let us now consider an alternative measure of distance for DNA sequences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>d_biology <span class="ot">&lt;-</span> d_pairs <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance_bio =</span> <span class="fu">list</span>(dna1, dna2) <span class="sc">%&gt;%</span> <span class="fu">pmap_dbl</span>(adist)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercise-4" class="level4">
<h4 class="anchored" data-anchor-id="exercise-4">Exercise 4</h4>
<ul>
<li>Again, make a histogram of the new distance and find the 10 DNA sequences closest to the plaintiff’s.</li>
</ul>
<div class="cell">

</div>
<ul>
<li>Which of the two measures do you find more adequate for these data?</li>
</ul>
</section>
<section id="exercise-5" class="level4">
<h4 class="anchored" data-anchor-id="exercise-5">Exercise 5</h4>
<ul>
<li>Imagine that you are a juror in this court case, would you find this piece of evidence convincing? Would you like to have more information? If so, what additional information would you need? Now, imagine that you are a judge; do you think that this piece of evidence should be admitted to court? Why?</li>
</ul>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>